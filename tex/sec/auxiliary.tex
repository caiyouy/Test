\begin{frame}
\frametitle{"Subspace" correction via auxiliary spaces}
Subspace decomposition is not available in some cases.
\begin{block}{Space decomposition via auxiliary spaces}
Select a sequence of spaces $V_1, \cdots, V_J$, each of them is related to $V$ by a linear map:
$$\Pi_i: V_i \mapsto V$$
Again, we assume, 
$$V=\sum_{i=1}^J\Pi_i V_i$$
\end{block}
\end{frame}

\begin{frame}
Auxiliary space: $\utilde{V}=V_1\times V_2 \times \cdots \times V_{J}$

Define that $\Pi=(\Pi_1,\Pi_2,\cdots,\Pi_{J}):\utilde{V}\mapsto V$,
$$\Pi \utilde{v}=\sum_{i=1}^{J}\Pi_i v_i,\qquad
\utilde{v}=(v_1,v_2,\cdots,v_J)$$
which is surjective.

For linear system: $Au=f$, $u \in V$ 
$$Au=f \Longleftrightarrow 
A\Pi\utilde{u}=f \Longleftrightarrow 
\Pi'A\Pi\utilde{u}=\Pi'b
$$
We get the expanded system,
$$\utilde{A}\utilde{u}=\utilde{f}$$
where
$$\utilde{A}=\Pi'A\Pi,\quad\utilde{f}=\Pi'f$$
\end{frame}

\begin{frame}
\frametitle{Iterative methods for expanded system}
\begin{theorem}
Iterative methods for $\utilde{A}\utilde{u}=\utilde{f}$:
$$\utilde{u}^m=\utilde{u}^{m-1}+\utilde{B}
(\utilde{f}-\utilde{A}\utilde{u}^{m-1})$$
is equivalent to the iterative method for $Au=f$:
$${u}^m={u}^{m-1}+{B}({f}-{A}{u}^{m-1})$$
with
$$u^m=\Pi \utilde{u}^m\qquad B=\Pi \utilde{B} \Pi'$$
\end{theorem}
Furthermore, if $\utilde{B}$ is SPD, then 
$B$ is also SPD, and 
$$(B^{-1}v,v)=
\inf_{\Pi\utilde{v}=v}(\utilde{B}^{-1}\utilde{v},\utilde{v})$$
\end{frame}

\begin{frame}
\frametitle{Subspace solver}
Assume that each $V_i$ is equipped with an inner product
$a_i(\cdot,\cdot)$.

\uncover<2>{
We define $A_{i}$ by $$(A_i u_i,v_i):=a_i(u_i,v_i),
\forall u_i,v_i \in V_i$$
and define $\Pi_i'$ be the adjoint of $\Pi_i$,
$$(\Pi_i'f,v_i):=(f,\Pi v_i),\forall f\in V\,', v_i \in V_i$$
and define $P_i=\Pi_i^{*}: V \mapsto V_i$ be the adjoint of 
$\Pi$ with respect to $A$-products.
$$(P_iu,v_i)_{A_i}:=(u,\Pi_i v_i)_A, \forall u \in V, v_i \in V_i$$
}
\begin{figure}[ht]
\begin{tikzpicture}
    \matrix (m) [matrix of ]
    {
    V_i' & V'\\
    V_i  & V\\
    };
    \path[-stealth]
    (m-2-1) edge node [left] {$A_i$} (m-1-1)
    (m-2-2) edge node [right] {$A$} (m-1-2);
\end{tikzpicture}
\end{figure}
The following identity holds:
$$\Pi_i'A=A_iP_i$$
\end{frame}

\begin{frame}
\frametitle{Subspace correction}
if $u$ is the solution of $Au=f$, then
$$A_iu_i=f_i$$
where $$u_i=P_iu, f_i=\Pi_i'f$$
This equation may be regarded as the restriction to $V_i$.
Assume each $A_i$ has an approximate inverse or preconditioner:
$$R_i: V_i\,'\mapsto V_i$$
\end{frame}

\begin{frame}
\frametitle{Parallel Subspace Correction}
\begin{algorithm}[H]
\caption{Parallel subspace correction}
\begin{algorithmic}[1]
\REQUIRE $u^0 \in V$
\REPEAT
\STATE $v \leftarrow u^k$
\FOR {i=1:J}
\STATE $v \leftarrow v + \Pi_i R_i \Pi'(f-Au^k)$ 
\ENDFOR
\STATE $u^{k+1} \leftarrow v$ 
\UNTIL{Convergence}
\end{algorithmic}
\end{algorithm}
It can be written as
$$u^{k+1}=u^{k}+B_{psc}(f-Au_{k})$$
where
$$B_{psc}=\sum_{i=1}^{J}\Pi_i R_i \Pi_i'$$
\end{frame}

\begin{frame}
\frametitle{Successive Subspace Correction}
\begin{algorithm}[H]
\caption{Successvie subspace correction}
\begin{algorithmic}[1]
\REQUIRE $u^0 \in V$
\REPEAT
\STATE $v \leftarrow u^k$
\FOR {i=1:J}
\STATE $v \leftarrow v + \Pi_i R_i \Pi'(f-Av)$ 
\ENDFOR
\STATE $u^{k+1} \leftarrow v$ 
\UNTIL{Convergence}
\end{algorithmic}
\end{algorithm}
It can be written as
$$u^{k+1}=u^{k}+B_{ssc}(f-Au_{k})$$
where $B_{ssc}$ is defined by
$I-B_{ssc}A=(I-T_{J})(I-T_{J-1})\cdots(I-T_1)$ and $T_i=\Pi_i R_i \Pi_i' A$
\end{frame}

\begin{frame}
\frametitle{PSC and SSC in the view from expanded system}
\begin{theorem}
The PSC for $Au=f$ is equivalent to the modified Jacobi method for 
$\utilde{A}\utilde{u}=\utilde{f}$:
$$\utilde{u}^m=\utilde{u}^{m-1}+\utilde{R}
(\utilde{f}-\utilde{A}\utilde{u}^{m-1})$$
The SSC for $Au=f$ is equivalent to the modified GS method for
$\utilde{A}\utilde{u}=\utilde{f}$:
$$\utilde{u}^m=\utilde{u}^{m-1}+(\utilde{R}^{-1}+\utilde{L})^{-1}
(\utilde{f}-\utilde{A}\utilde{u}^{m-1})$$
\end{theorem}
\end{frame}

\begin{frame}
\frametitle{Convergence analysis for SSC}
\begin{theorem}
Assume that $\utilde{\bar{R}}=\utilde{R}'+\utilde{R}-\utilde{R}'\utilde{D}\utilde{R}$
is SPD, Then for SSC
$$\utilde{\bar{B}}^{-1} =(\utilde{I}+\utilde{R}' \utilde{U})' 
\utilde{\bar{R}}^{-1}
(\utilde{I}+\utilde{R}' \utilde{U})$$ 
$$=\utilde{A}+(\utilde{D}+\utilde{U}-\utilde{R}^{-1})'\utilde{R}
\utilde{\bar{R}}^{-1}
\utilde{R}'(\utilde{D}+\utilde{U}-\utilde{R}^{-1})$$
\end{theorem}
\end{frame}

\begin{frame}
\frametitle{XZ identity: general cases}
\begin{theorem}
The SSC is convergent if each subspace solver is convergent:
$$\Vert I-B A \Vert_{A}^{2}=1-\frac{1}{c_{1}}=1-\frac{1}{1+c_{0}}$$
where 
$$
c_{1}=\sup_{\Vert v \Vert=1}\inf_{\sum_{i} v_i=v}
\sum_{i=1}^{J}\Vert v_{i}+R_{i}^{\prime} A_{i} P_{i}
\sum_{j=i+1}^{J} \Pi_{j} v_{j}\Vert_{\bar{R}_{i}^{-1}}^{2}
$$
and
$$
c_{0}=\sup_{\Vert v \Vert=1}\inf_{\sum_{i} v_i=v}
\sum_{i=1}^{J}\Vert R_{i}^{\prime}(A_{i} P_{i}
\sum_{j=i}^{J} \Pi_{j} v_{j}-R_i^{-1}v_i \Vert_{\bar{R}_{i}^{-1}}^{2}
$$
\end{theorem}
\end{frame}

\begin{frame}
\frametitle{XZ identity: special cases}
\begin{theorem}
If each subspace solver is exact, i.e. $R_i=A_i^{-1}$, it holds that
$$\Vert I-B A \Vert_{A}^{2}=1-\frac{1}{c_{1}}=1-\frac{1}{1+c_{0}}$$
where 
$$
c_{1}=\sup_{\Vert v \Vert=1}\inf_{\sum_{i} v_i=v}
\sum_{i=1}^{J}\Vert P_{i}
\sum_{j=i}^{J} \Pi_{j} v_{j}\Vert_{A_i}^{2}
$$
and
$$
c_{0}=\sup_{\Vert v \Vert=1}\inf_{\sum_{i} v_i=v}
\sum_{i=1}^{J}\Vert P_{i}
\sum_{j=i+1}^{J} \Pi_{j} v_{j}\Vert_{A_i}^{2}
$$
\end{theorem}
\end{frame}

\begin{frame}
\textbf{Remarks:}
\begin{itemize}
 \item PSC convergence?
 
 Jacobi method is not convergent for all SPD problems.
 
 \item PSC/SSC is often used as preconditioner.
\end{itemize}

\begin{block}{Linear iteration as preconditioner}
A sufficient condition for convergence:
$$k=\Vert I-BA \Vert_A <1$$
which means, when $B$ is symmetric,
$$\kappa(BA)\le \frac{1+k}{1-k}$$ 
Then if $B$ is used as preconditioner for CG,
$$\delta=\frac{\sqrt{\kappa(BA)}-1}{\sqrt{\kappa(BA)}+1}\le \frac{\sqrt{\frac{1+k}{1-k}}-1}{\sqrt{\frac{1+k}{1-k}}+1}=
\frac{1-\sqrt{1-k^2}}{k}<k$$
\end{block}
\end{frame}
